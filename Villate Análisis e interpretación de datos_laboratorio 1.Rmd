---
title: "Análisis e Interpretación de datos"
author: "Angela Villate"
date: '2023-12-12'
output: pdf_document
---
Este documento se presenta como anexo del laboratorio 1 "estadística descriptiva e interpretación de datos"
El objetivo del laboratorio es el de corroborar a través de técnicas de estadística descriptiva si el Estado colombiano siguió el criterio de optimización de recursos al momento de adquirir las vacunas para el Covid 19, durante los años 2021 y 2022. Se presenta un análisis visual, análisis de variables numéricas y variables categóricas


```{r setup, include=FALSE}
#Lectura de datos
library(readr)
data=Asignaci_n_de_dosis_de_vacuna_contra_COVID_19 <- read_csv("Asignaci_n_de_dosis_de_vacuna_contra_COVID-19.csv")
View(data)

```

```{r}

# Verificar el tipo de datos actual de la columna
class(data$Cantidad)

# Convertir la columna a números
data$Cantidad <- as.numeric(data$Cantidad)

# Verificar el tipo de datos después de la conversión
class(data$Cantidad)
```
```{r}
# Instalar y cargar el paquete ggplot2 si no está instalado
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Convertir 'Año' a formato de fecha si no está en ese formato
data_clean$Año <- as.Date(data_clean$Año)

# Crear un gráfico de líneas con ggplot2
ggplot(data_clean, aes(x = Año, y = Laboratorio_Vacuna, color = Laboratorio_Vacuna)) +
  geom_line(size = 2) +
  labs(title = "Gráfico de Línea por tipo de laboratorio", x = "Tiempo", y = "Laboratorio") +
  theme_minimal()
```


```{r}
ggplot(data, aes(x = Año, fill = Laboratorio_Vacuna)) +
  geom_bar(position = "stack") +
  labs(title = "Gráfico de Barras Apiladas por tipo de laboratorio y año", x = "Año", y = "Conteo") +
  theme_minimal()
```


```{r}
ggplot(data, aes(x = Laboratorio_Vacuna, y = Cantidad, fill = Laboratorio_Vacuna)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Gráfico de Barras Agrupadas por tipo de laboratorio y Cantidad", x = "Laboratorio_Vacuna", y = "Cantidad") +
  theme_minimal()
```

```{r}
ggplot(data, aes(x = Laboratorio_Vacuna, y = Cantidad, fill = factor(Año))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Gráfico de Barras Agrupadas por tipo de laboratorio, Año y Cantidad", x = "Laboratorio_Vacuna", y = "Cantidad") +
  theme_minimal()
```
```{r}
# Instalar el paquete forcats si no está instalado
if (!requireNamespace("forcats", quietly = TRUE)) {
  install.packages("forcats")
}

# Cargar el paquete forcats
library(forcats)
```


```{r}
# Calcular el top 10 de Nom_Territorio por la suma de Cantidad
top_n_territorios <- data %>%
  group_by(Nom_Territorio) %>%
  summarize(Total_Cantidad = sum(Cantidad)) %>%
  top_n(10, Total_Cantidad)

# Filtrar los datos originales para incluir solo las observaciones del top 10
data_top10 <- data[data$Nom_Territorio %in% top_n_territorios$Nom_Territorio, ]
```

```{r}
ggplot(data_top10, aes(x = fct_reorder(Nom_Territorio, Cantidad), y = Cantidad, fill = Laboratorio_Vacuna)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.9) +
  labs(
    title = "Top 10 Territorios por Cantidad, Laboratorio y Cantidad",
    x = "Nom_territorio",
    y = "Cantidad"
  ) +
  theme_minimal(base_size = 8) +  # Ajustar el tamaño de la fuente del tema
  theme(axis.text.x = element_text(size = 4),  # Ajustar el tamaño de la fuente del eje x
        axis.text.y = element_text(size = 8))  # Ajustar el tamaño de la fuente del eje y
```

```{r}
bottom_n_territorios <- data %>%
  group_by(Nom_Territorio) %>%
  summarize(Cantidad = sum(Cantidad)) %>%
  top_n(-10, Cantidad)  # Utilizar top_n con un signo negativo para seleccionar los 10 menores

# Filtrar los datos originales para incluir solo las observaciones del bottom 10
data_bottom10 <- data[data$Nom_Territorio %in% bottom_n_territorios$Nom_Territorio, ]

# Ajustar tamaño de la fuente
mi_grafico_bottom10 <- ggplot(data_bottom10, aes(x = fct_reorder(Nom_Territorio, Cantidad), y = Cantidad, fill = Laboratorio_Vacuna)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
    title = "Bottom 10 Territorios por Cantidad, Laboratorio y Cantidad",
    x = "Nom_territorio",
    y = "Cantidad"
  ) +
  theme_minimal(base_size = 8) +  
  theme(axis.text.x = element_text(size = 8), 
        axis.text.y = element_text(size = 8))


```


```{r}
# Guardar el gráfico como un archivo JPEG
ggsave("mi_grafico_bottom10.jpg", plot = mi_grafico_bottom10, width = 8, height = 6, dpi = 300)
```


```{r}
prop.table(table(data$Laboratorio_Vacuna, data$Uso_vacuna), margin = 1)
barplot(prop.table(table(data$Laboratorio_Vacuna, data$Uso_vacuna), margin = 1),
        beside = TRUE,
        legend.text = TRUE,
        col = c("lightblue", "lightgreen"),
        main = "Proporciones de Uso_vacuna por Laboratorio_Vacuna",
        xlab = "Laboratorio_Vacuna",
        ylab = "Proporción")
```


```{r}
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Ajustar tamaño de la fuente
mi_grafico <- ggplot(data_top10, aes(x = fct_reorder(Nom_Territorio, Cantidad), y = Cantidad, fill = Laboratorio_Vacuna)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.9) +
  labs(
    title = "Top 10 Territorios por Cantidad, Laboratorio y Cantidad",
    x = "Nom_territorio",
    y = "Cantidad"
  ) +
  theme_minimal(base_size = 8) +  
  theme(axis.text.x = element_text(size = 4), 
        axis.text.y = element_text(size = 8))

# Guardar el gráfico como un archivo JPEG
ggsave("mi_grafico.jpg", plot = mi_grafico, width = 8, height = 6, dpi = 300)
```


```{r}
summary(data_clean$Laboratorio_Vacuna)
```

### medidas de tendencia central
```{r cars}
data <- na.omit(data)

# Calcular la media
media <- mean(data$Cantidad)

# Calcular la mediana
mediana <- median(data$Cantidad)

# Calcular la moda (puedes usar una función personalizada)
moda <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
moda_resultado <- moda(data$Laboratorio_Vacuna)

# Mostrar los resultados
print(paste("Media:", media))
print(paste("Mediana:", mediana))
print(paste("Moda:", moda_resultado))
```


### medidas de dispersión

```{r}
set.seed(123)  # Para reproducibilidad
datos <- data.frame(Cantidad = rnorm(100, mean = 50, sd = 10))

# Calcular el rango
rango <- diff(range(data$Cantidad))

# Calcular la desviación estándar
desviacion_estandar <- sd(data$Cantidad)

# Imprimir los resultados
cat("Rango: ", rango, "\n")
cat("Desviación Estándar: ", desviacion_estandar, "\n")
```

```{r}
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Crear un histograma
ggplot(datos, aes(x = Cantidad)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de la variable Cantidad", x = "Cantidad", y = "Frecuencia") +
  theme_minimal()

# Crear un diagrama de caja
ggplot(datos, aes(y = Cantidad)) +
  geom_boxplot(fill = "lightblue", color = "blue") +
  labs(title = "Diagrama de Caja de la variable Cantidad", y = "Cantidad") +
  theme_minimal()
```

```{r}
# Calcular percentiles por año
percentiles_por_Año <- data %>%
  group_by(Año) %>%
  summarize(Q1 = quantile(Cantidad, 0.25),
            Q2 = quantile(Cantidad, 0.5),
            Q3 = quantile(Cantidad, 0.75))

percentiles_por_Año
```

```{r}
# Gráfico de líneas con percentiles
ggplot(percentiles_por_Año, aes(x = Año, group = 1)) +
  geom_line(aes(y = Q1), linetype = "dashed", color = "blue", size = 1) +
  geom_line(aes(y = Q2), linetype = "dashed", color = "green", size = 1) +
  geom_line(aes(y = Q3), linetype = "dashed", color = "red", size = 1) +
  labs(title = "Percentiles por Año para la variable Cantidad", x = "Año", y = "Cantidad") +
  theme_minimal()
```

```{r}
install.packages("e1071")
```

```{r}
# Instalar y cargar el paquete
library(e1071)

# Calcular asimetría y curtosis para la variable 'Cantidad'
asimetria <- skewness(data$Cantidad)
curtosis <- kurtosis(data$Cantidad)

# Imprimir resultados
cat("Asimetría:", asimetria, "\n")
cat("Curtosis:", curtosis, "\n")
```

```{r}
# Visualizar la distribución con un histograma
ggplot(data, aes(x = Cantidad)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de la variable Cantidad", x = "Cantidad", y = "Frecuencia") +
  theme_minimal()

# Visualizar la distribución con un gráfico de densidad
ggplot(data, aes(x = Cantidad)) +
  geom_density(fill = "blue", alpha = 0.7) +
  labs(title = "Gráfico de Densidad de la variable Cantidad", x = "Cantidad", y = "Densidad") +
  theme_minimal()
```

```{r}
# Frecuencias absolutas para Laboratorio_Vacuna
frec_abs_lab <- table(data$Laboratorio_Vacuna)

# Frecuencias relativas (porcentaje) para Laboratorio_Vacuna
frec_rel_lab <- prop.table(frec_abs_lab) * 100

# Imprimir resultados para Laboratorio_Vacuna
cat("Frecuencias absolutas para Laboratorio_Vacuna:\n")
print(frec_abs_lab)

cat("\nFrecuencias relativas (porcentaje) para Laboratorio_Vacuna:\n")
print(frec_rel_lab)

# Frecuencias absolutas para Nom_Territorio
frec_abs_territorio <- table(data$Nom_Territorio)

# Frecuencias relativas (porcentaje) para Nom_Territorio
frec_rel_territorio <- prop.table(frec_abs_territorio) * 100

# Imprimir resultados para Nom_Territorio
cat("\nFrecuencias absolutas para Nom_Territorio:\n")
print(frec_abs_territorio)

cat("\nFrecuencias relativas (porcentaje) para Nom_Territorio:\n")
print(frec_rel_territorio)
```

```{r}
# Frecuencias absolutas y relativas para Laboratorio_Vacuna
frec_lab <- as.data.frame(table(data$Laboratorio_Vacuna))
frec_lab$Percent <- prop.table(frec_lab$Freq) * 100

# Gráfico de barras para Laboratorio_Vacuna
ggplot(frec_lab, aes(x = reorder(Var1, -Freq), y = Freq, fill = Var1)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(Freq, " (", round(Percent, 1), "%)")), vjust = -0.5, size = 3) +
  labs(title = "Frecuencias para Laboratorio_Vacuna", x = "Laboratorio_Vacuna", y = "Frecuencia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Frecuencias absolutas y relativas para Nom_Territorio
frec_territorio <- as.data.frame(table(data$Nom_Territorio))
frec_territorio$Percent <- prop.table(frec_territorio$Freq) * 100

# Gráfico de barras para Nom_Territorio
ggplot(frec_territorio, aes(x = reorder(Var1, -Freq), y = Freq, fill = Var1)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(Freq, " (", round(Percent, 1), "%)")), vjust = -0.5, size = 3) +
  labs(title = "Frecuencias para Nom_Territorio", x = "Nom_Territorio", y = "Frecuencia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Instalar y cargar el paquete
install.packages("vcd")
library(vcd)

# Crear la tabla de contingencia
tabla_contingencia <- table(data$Laboratorio_Vacuna, data$Nom_Territorio)

# Mostrar la tabla de contingencia
print("Tabla de Contingencia:")
print(tabla_contingencia)

# Calcular el coeficiente de contingencia
coef_contingencia <- assocstats(tabla_contingencia)
print("\nCoeficiente de Contingencia:")
print(coef_contingencia$cramersV)

# Realizar la prueba de Chi-cuadrado
chi_cuadrado <- chisq.test(tabla_contingencia)
print("\nPrueba de Chi-cuadrado:")
print(chi_cuadrado)
```

```{r}

# Crear la tabla de contingencia
tabla_contingencia <- table(data$Laboratorio_Vacuna, data$Nom_Territorio)

# Crear un gráfico de mosaico
mosaic(tabla_contingencia, shade = TRUE, legend = TRUE)

```

